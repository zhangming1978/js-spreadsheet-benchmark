# 功能规格说明

## 1. 项目概述

JS Spreadsheet Benchmark 是一个开源的性能基准测试工具，用于客观、透明地对比主流 JavaScript 电子表格库在常见业务场景下的性能表现。

**设计目标**：
- 为开发者选型提供客观的性能参考数据
- 测试方法公开透明，结果可在本地复现
- 通过适配器模式支持扩展更多产品

---

## 2. 功能需求

### 2.1 产品选择

- 支持同时选择多个产品进行对比
- 显示各产品的版本信息
- 支持单独查看某一产品的性能表现

### 2.2 测试场景

#### A. 数据加载性能
- 小数据集：1,000 行 × 10 列
- 中数据集：10,000 行 × 20 列
- 大数据集：50,000 行 × 50 列
- 超大数据集：100,000 行 × 100 列

#### B. 滚动性能
- 垂直/水平滚动流畅度（FPS）
- 大数据集下的滚动响应时间

#### C. 编辑操作性能
- 单元格编辑响应时间（模拟输入 100 次）
- 批量数据粘贴（1,000 单元格）
- 批量数据填充（自动填充 1,000 单元格）
- 批量单元格样式修改（1,000 单元格）
- 撤销/重做操作响应时间（连续 50 次）

#### D. 公式计算性能
- 简单公式（SUM, AVERAGE）— 10,000 个
- 复杂公式（VLOOKUP, INDEX/MATCH）— 1,000 个
- 公式链式依赖计算

#### E. 渲染性能
- 初始渲染时间
- 条件格式渲染（1,000 条规则）
- 图表渲染（10 个图表）

#### F. 内存占用
- 空白工作簿内存占用
- 加载 10,000 / 100,000 行数据后的内存占用

#### G. Excel 文件导入性能
- 用户上传 .xlsx 文件，测量从读取到完全渲染的时间
- 提供不同规模的示例文件（1k / 10k / 50k 行）

### 2.3 测试控制

- 一键启动全部测试
- 支持中途暂停/继续/停止
- 显示实时进度和当前测试项
- 测试完成后自动生成对比报告

### 2.4 结果可视化

- 柱状对比图：横向对比各产品在同一指标下的表现
- 雷达图：综合展示各产品多维度性能
- 趋势折线图：不同数据规模下的性能变化
- 详细数据表格

### 2.5 数据导出

- 导出测试结果为 JSON
- 导出测试报告为 PDF
- 导出图表为 PNG

---

## 3. 性能指标定义

| 指标 | 单位 | 说明 |
|------|------|------|
| 初始加载时间 | ms | 从开始加载到首次可交互 |
| 数据渲染时间 | ms | 加载数据到完全渲染 |
| 滚动帧率 | FPS | 滚动时的帧率 |
| 编辑响应时间 | ms | 单元格编辑到界面更新 |
| 公式计算时间 | ms | 公式计算完成时间 |
| 内存占用 | MB | 运行时内存占用 |
| Excel 导入时间 | ms | 文件导入并渲染完成 |

**测试方法**：
- 每个场景运行 3 次，取平均值
- 使用 Performance API 精确计时
- 使用 Memory API 监控内存
- 使用 requestAnimationFrame 监控帧率

---

## 4. 非功能需求

### 公正性
- 所有产品使用相同的测试数据和测试环境
- 测试代码开源，接受社区审查
- 明确标注各产品版本号和测试日期

### 可靠性
- 测试结果可重现
- 测试失败时有明确错误提示
- 支持失败后重试

### 可维护性
- 适配器模式，易于添加新产品
- 测试用例易于扩展和修改

### 安全性
- 不收集用户个人信息
- 所有计算在客户端完成，无数据上传

---

## 5. 兼容性

- Chrome 90+
- Edge 90+
- Firefox 88+
- Safari 14+
- 推荐桌面端访问（1920×1080 及以上）

---

**文档版本**：v2.0
**更新日期**：2026-02-25
